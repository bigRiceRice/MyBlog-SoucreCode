---
title: Array.prototype.reduce
author: BigRice
date: 2022-02-21
location: äº‘æ¢¦æ³½
summary: reduce() å®ä¾‹æ–¹æ³•æ˜¯ä¸€ä¸ªæ ¹æ®æ•°ç»„é•¿åº¦ä¸æ•°ç»„ä¸­çš„å€¼è¿›è¡Œç´¯ç§¯è®¡ç®—çš„æ–¹æ³•
tags:
  - JsApi
  - ArrayMethods
---

`reduce()` å®ä¾‹æ–¹æ³•æ˜¯ä¸€ä¸ªæ ¹æ®æ•°ç»„é•¿åº¦ä¸æ•°ç»„ä¸­çš„å€¼è¿›è¡Œ**ç´¯ç§¯è®¡ç®—**çš„æ–¹æ³•

```js
reduce(callback(previousValue, item, index, array), [initialValue]);
```

- _`previousValue`_ çš„å€¼é¦–æ¬¡å¾ªç¯ä¸­çš„å€¼æœ‰ä¸‹é¢ä¸¤ç§æƒ…å†µï¼Œå†åç»­å¾ªç¯ä¸­æ˜¯ `callback` **ä¸Šä¸€æ¬¡æ‰§è¡Œçš„è¿”å›ç»“æœ**ï¼Œ

  | è‹¥å£°æ˜äº† _initialValue_ ğŸŸ¢ | è‹¥æ²¡æœ‰å£°æ˜ _initialValue_ ğŸ”´ |
  | :------------------------: | :--------------------------: |
  |    å€¼ä¸º _initialValue_     |        å€¼ä¸º `arr[0]`         |

- `item` çš„å€¼åœ¨**é¦–æ¬¡å¾ªç¯**ä¸­çš„å€¼æœ‰ä¸‹é¢ä¸¤ç§æƒ…å†µï¼Œå†åç»­éšå¾ªç¯é€’å¢ï¼š

  | è‹¥å£°æ˜äº† _initialValue_ ğŸŸ¢ | è‹¥æ²¡æœ‰å£°æ˜ _initialValue_ ğŸ”´ |
  | :------------------------: | :--------------------------: |
  |     åˆå§‹å€¼ä¸º `arr[0]`      |      åˆå§‹å€¼ä¸º `arr[1]`       |

- `elementIndex` å½“å‰å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•

- `array` ä¸ºè°ƒç”¨ `reduce` çš„æ•°ç»„

- `initialValue` **å¯é€‰**ã€‚
  - è‹¥å£°æ˜äº†è¯¥å€¼ï¼Œé‚£ä¹ˆ `previousValue` åœ¨ç¬¬ä¸€æ¬¡å¾ªç¯çš„å€¼å°±æ˜¯è¯¥å€¼

|            æ­¤æ–¹æ³•çš„è¿”å›å€¼            | æ­¤æ–¹æ³•ä¼šå½±å“æºæ•°ç»„å— | å…¼å®¹æ€§ |
| :----------------------------------: | :------------------: | :----: |
| ä¸ºæœ€åä¸€æ¬¡å¾ªç¯ `callback()` çš„è¿”å›å€¼ |       **ä¸ä¼š**       |   ğŸŸ¢   |

### æ³¨æ„

`reduce` çš„æ‰§è¡Œæ˜¯æœ‰**ç‰¹æ®Šæƒ…å†µ**çš„ï¼š

1. å½“å£°æ˜äº† `initialValue` ä¸”æ•°ç»„ä¸ºç©ºæ•°ç»„æ—¶ï¼Œ`reduce()` éƒ½å°†ç›´æ¥è¿”å› `initialValue
2. å½“æœªå£°æ˜ `initialValue` ä¸”æ•°ç»„çš„é•¿åº¦ä¸º `2` ä»¥ä¸‹ï¼Œ`reduce()` éƒ½ç›´æ¥è¿”å› `arr[0]`
3. è‹¥æ•°ç»„ä¸ºç©ºä¸”æ²¡æœ‰åˆå§‹å€¼ï¼Œæ–¹æ³•å°†æŠ¥é”™

### æ€»ç»“

`initialValue` çš„åˆå§‹å€¼æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µ

1.  `reduce()` **æœ‰æä¾›** `initialValue` å‚æ•°ï¼Œé‚£ä¹ˆç´¯åŠ å™¨åˆå§‹å€¼å°±æ˜¯ `initialValue`ï¼Œ_element_ å°±æ˜¯ `arr[0]`
2.  `reduce()` **æ²¡æœ‰æä¾›** `initialValue` å‚æ•°ï¼Œé‚£ä¹ˆç´¯åŠ å™¨åˆå§‹å€¼å°±æ˜¯ `array[0]`ï¼Œ_element_ å°±æ˜¯ `arr[1]`

`reduce` çš„æœ€ä½³è°ƒç”¨

- å¦‚æœå£°æ˜ `initialValue` ï¼Œä½ è‡³å°‘å¾—ä¿è¯æ•°ç»„é•¿åº¦ä¸º `>=2`
- å¦‚æœæœªå£°æ˜ `initialValue`ï¼Œä½ è‡³å°‘å¾—ä¿è¯æ•°ç»„é•¿åº¦ä¸º `>=1`
- [JS reduce()æ–¹æ³•è¯¦è§£](https://www.cnblogs.com/echolun/p/11929564.html)

> ç¤ºä¾‹

`reduce` å®ç°**æ•°ç»„æ±‚å’Œ**

```js
var arr = [1, 50, 12, 54];
var sum = arr.reduce((count, ele) => {
  //é¦–æ¬¡æ‰§è¡Œæ—¶ count ä¸º arr[0]:1)ï¼Œele ä¸º arr[1]:(50)
  return count + ele;
});
console.log(sum); //> 117
```

`reduce` å®ç°**æ•°ç»„å»é‡**

```js
var arr = [1, 50, 1, 54, null, null];
let newArr = arr.reduce((pre, ele) => {
    // å‡½æ•°ä½“æ‰§è¡Œæ—¶ï¼Œpre å§‹ç»ˆä¸ºæ•°ç»„ï¼Œele ä¸º arr[0] é€’å¢
    // ç¬¬1è½®ï¼šæ­¤æ—¶ pre è¿˜æ˜¯ä¸ªç©ºæ•°ç»„ï¼Œä¸å¯èƒ½å­˜åœ¨ ele ( ele æ­¤æ—¶ä¸º[arr0](1) )ï¼Œæ‰€ä»¥å°†å®ƒæ‹¼æ¥å¹¶è¿”å›æ–°æ•°ç»„
    // 		>> return [1]
    // ç¬¬2è½®ï¼šæ­¤æ—¶ pre ä¸º [1]ï¼Œele ä¸º arr[1](50)ï¼Œè¿˜æ˜¯ä¸å­˜åœ¨ï¼Œç»§ç»­å°†å®ƒæ‹¼æ¥å¹¶è¿”å›æ–°æ•°ç»„
    // 		>> return [1].concat(50)
    // ä¾æ¬¡ç±»æ¨ï¼Œæ•°ç»„ä¸­ä¸å­˜åœ¨æ­¤å…ƒç´ å°±ä½¿ç”¨ concat æ–¹æ³•æ‹¼æ¥è¿”å›ï¼Œæ•°ç»„ä¸­å­˜åœ¨æ­¤å…ƒç´ å°±å°†æ•°ç»„ç›´æ¥è¿”å›ã€‚
    return pre.includes(ele) ? pre : pre.concat(ele)
}, [])
console.log(newArr);//> [1,50,54,null]
// æ‰§è¡Œè¿‡ç¨‹
    > [],1
    > [1],50
    > [1,50],1
    > [1,50],54
    > [1,50,54],null
    > [1,50,54,null],null
    > [1,50,54,null]
```

`reduce` å®ç°**æ•°ç»„é™ç»´**

```js
// äºŒç»´è½¬ä¸€ç»´
let arr1 = [[1, 2], [3, 4], [5, 6]]
arr1.reduce((pre, current) => pre.concat(current), []);//[1, 2, 3, 4, 5, 6]
------
// å¤šç»´è½¬ä¸€ç»´
let arr2 = [0, [1], [2, 3], [4, [5, 6, 7]]];

function newArray (arr) {
    // æ•°ç»„æ‹¼æ¥
    // å¦‚æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå°±é€’å½’è°ƒç”¨å®ƒè¿›å…¥åˆ°å®ƒçš„å†…éƒ¨ï¼Œç›´åˆ°ä¸æ˜¯æ•°ç»„è€Œæ˜¯å…ƒç´ æ—¶ï¼Œæ‰å°†å…¶æ‹¼æ¥
    return arr.reduce((pre, ele) =>  pre.concat(Array.isArray(ele) ? newArray(ele) : ele), []);
}
console.log(newArray(arr2)); //[0, 1, 2, 3, 4, 5, 6, 7]
// æ‰§è¡Œè¿‡ç¨‹
    > [],0
    > [0],[1]
    > é€’å½’è¿›å…¥å†…éƒ¨
    > [],1
    > [0,1],[2,3]
    > é€’å½’è¿›å…¥å†…éƒ¨
    > [],2
    > [2],3
    > [0,1,2,3],[4,[5,6,7]]
    > é€’å½’è¿›å…¥å†…éƒ¨
    > [],4
    > [4],[5,6,7]
    > é€’å½’è¿›å…¥å†…éƒ¨
    > [],5
    > [5],6
    > [5,6],7
    > [0,1,2,3,4,5,6,7]
```

åˆ¤æ–­æ•°ç»„ä¸­ `isDone` ä¸º `true` çš„å¯¹è±¡æœ‰å‡ ä¸ª

```javascript
let arr = [
  { name: "æµ‹è¯•1", isDone: true },
  { name: "æµ‹è¯•2", isDone: false },
  { name: "æµ‹è¯•3", isDone: true },
  { name: "æµ‹è¯•4", isDone: false },
];
let number = arr.reduce((count, ele) => {
  //å¦‚æœ isDone ä¸º true
  if (ele.isDone) {
    return count + 1; // ä¸è¦å†™æˆ count++ å› ä¸º 0++ æ˜¯
  } else return count;
}, 0); //å®šä¹‰ count åˆå§‹å€¼ä¸º0

// ä¸Šé¢è¿™æ®µä»£ç å¯ä»¥ç®€åŒ–ä¸ºå¦‚ä¸‹ä»£ç 
number = arr.reduce((count, ele) => (ele.isDone ? count + 1 : count), 0);
//> 2
```

è®¡ç®—æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ¬¡æ•°

```js
let arr = ["Banana", "Apple", "Banana", "Orange"];
let obj = arr.reduce((pre, ele) => {
  if (ele in pre) {
    // å‡ºç°äº†é‡å¤çš„ï¼Œå°†å®ƒçš„å€¼é€’å¢
    pre[ele]++;
  } else {
    // æ¯ä¸ªå…ƒç´ é¦–æ¬¡éƒ½ä¼šç›´æ¥è¿›å…¥æ­¤åˆ¤æ–­ï¼Œåœ¨æŒ‡å®šçš„ ele å±æ€§ä¸Šè®¾ç½®å€¼ä¸º 1
    pre[ele] = 1;
  }
  return pre;
}, {});
console.log(obj); // {Banana: 2, Apple: 1, Orange: 1}
```
